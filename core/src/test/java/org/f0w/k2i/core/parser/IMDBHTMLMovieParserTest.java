package org.f0w.k2i.core.parser;

import lombok.val;
import org.f0w.k2i.core.DocumentSourceType;
import org.f0w.k2i.core.model.entity.Movie;
import org.junit.Before;
import org.junit.Test;

import java.util.Arrays;

import static org.f0w.k2i.TestHelper.getResourceContents;
import static org.junit.Assert.assertEquals;

public class IMDBHTMLMovieParserTest extends BaseMovieParserTest {
    @Before
    public void setUp() throws Exception {
        parser = MovieParsers.ofSourceType(DocumentSourceType.IMDB_HTML);
    }

    @Test
    public void parseWithValidData() throws Exception {
        val expected = Arrays.asList(
                new Movie("Начало", 2010, Movie.Type.MOVIE, null, "tt1375666"),
                new Movie("Forget About It", 2011, Movie.Type.SERIES, null, "tt2125844"),
                new Movie("The Angry Joe Show", 2009, Movie.Type.SERIES, null, "tt2242729"),
                new Movie("Список контактов", 2008, Movie.Type.MOVIE, null, "tt0800240"),
                new Movie("Восприятие", 2012, Movie.Type.SERIES, null, "tt1714204"),
                new Movie("Обман", 2013, Movie.Type.SERIES, null, "tt2245029"),
                new Movie("Conception", 2011, Movie.Type.MOVIE, null, "tt1619277"),
                new Movie("Обман", 1946, Movie.Type.MOVIE, null, "tt0038461"),
                new Movie("Inception: The Cobol Job", 2010, Movie.Type.MOVIE, null, "tt5295894"),
                new Movie("The Inception", 2016, Movie.Type.SHORT, null, "tt5526902"),
                new Movie("Купи, одолжи, укради!", 2008, Movie.Type.MOVIE, null, "tt0985593"),
                new Movie("Deception", 2004, Movie.Type.MOVIE, null, "tt0384908"),
                new Movie("The Deception", 2012, Movie.Type.MOVIE, null, "tt2070841"),
                new Movie("Honest Trailers", 2012, Movie.Type.SERIES, null, "tt2619934"),
                new Movie("Richard Roeper & the Movies", 2009, Movie.Type.SERIES, null, "tt2278249"),
                new Movie("Pulp Interviews", 2011, Movie.Type.SERIES, null, "tt2032929"),
                new Movie("Bum Reviews", 2008, Movie.Type.SERIES, null, "tt1799669"),
                new Movie("CheeseBites", 2015, Movie.Type.SERIES, null, "tt5358710"),
                new Movie("Workforce", 2013, Movie.Type.SERIES, null, "tt2967010"),
                new Movie("The Distressed Watcher", 2010, Movie.Type.SERIES, null, "tt1886283"),
                new Movie("Elevator", 2007, Movie.Type.SERIES, null, "tt1805871"),
                new Movie("HBO First Look", 1992, Movie.Type.SERIES, null, "tt1695201"),
                new Movie("Zoom In", 2008, Movie.Type.SERIES, null, "tt3022202"),
                new Movie("Cute Girl Movie Review", 2013, Movie.Type.SERIES, null, "tt2805052"),
                new Movie("The Breaks", 2013, Movie.Type.SERIES, null, "tt4364692"),
                new Movie("Deceptions", 1985, Movie.Type.MOVIE, null, "tt0089008"),
                new Movie("Interception", 2009, Movie.Type.MOVIE, null, "tt0977658"),
                new Movie("Perception", 2015, Movie.Type.MOVIE, null, "tt3259276"),
                new Movie("Deception", 2013, Movie.Type.SERIES, null, "tt2339850"),
                new Movie("Reception", 2011, Movie.Type.SERIES, null, "tt1845098"),
                new Movie("Deception", 2003, Movie.Type.MOVIE, null, "tt0331464"),
                new Movie("Deceptions", 1990, Movie.Type.MOVIE, null, "tt0099390"),
                new Movie("Deception", 2010, Movie.Type.MOVIE, null, "tt1278330"),
                new Movie("Perception", 2005, Movie.Type.MOVIE, null, "tt0427650"),
                new Movie("Обман", 2013, Movie.Type.MOVIE, null, "tt2179226"),
                new Movie("Deception", 2000, Movie.Type.MOVIE, null, "tt0251046"),
                new Movie("Bare Deception", 2000, Movie.Type.MOVIE, null, "tt0222786"),
                new Movie("Misconceptions", 2008, Movie.Type.MOVIE, null, "tt1172066"),
                new Movie("Deception", 2013, Movie.Type.SHORT, null, "tt2290259"),
                new Movie("Deception", 2015, Movie.Type.SHORT, null, "tt3512542"),
                new Movie("Inception: Motion Comics", 2010, Movie.Type.SERIES, null, "tt1790736"),
                new Movie("Interception", 2011, Movie.Type.SHORT, null, "tt2112973"),
                new Movie("Anatomy of Deception", 2014, Movie.Type.MOVIE, null, "tt2672660"),
                new Movie("Twinning", 2015, Movie.Type.SERIES, null, "tt5027458"),
                new Movie("Monday Afternoon Live", 2014, Movie.Type.SERIES, null, "tt3664792"),
                new Movie("Epic Meal Empire", 2014, Movie.Type.SERIES, null, "tt4016836"),
                new Movie("Under Covers", 2015, Movie.Type.SERIES, null, "tt4938392"),
                new Movie("Code MENT", 2009, Movie.Type.SERIES, null, "tt4242950"),
                new Movie("Downtown Girls", 2013, Movie.Type.SERIES, null, "tt4795708"),
                new Movie("Oh No! It's an Alien Invasion", 2013, Movie.Type.SERIES, null, "tt4878010"),
                new Movie("Deception", 2006, Movie.Type.SHORT, null, "tt0853235"),
                new Movie("Reconception", 2009, Movie.Type.MOVIE, null, "tt1693869"),
                new Movie("Reception", 2013, Movie.Type.SHORT, null, "tt3476440"),
                new Movie("Perception", 2009, Movie.Type.MOVIE, null, "tt1047514"),
                new Movie("Deception", 2016, Movie.Type.SHORT, null, "tt5624342"),
                new Movie("WWA: The Inception", 2001, Movie.Type.MOVIE, null, "tt0311992"),
                new Movie("Deception", 2016, Movie.Type.SERIES, null, "tt5527918"),
                new Movie("Ultimate Deception", 1999, Movie.Type.MOVIE, null, "tt0164211"),
                new Movie("The Reception", 2005, Movie.Type.MOVIE, null, "tt0457452"),
                new Movie("The Exception", 2013, Movie.Type.SHORT, null, "tt3225970"),
                new Movie("Vows of Deception", 1996, Movie.Type.MOVIE, null, "tt0117832"),
                new Movie("Secrets of Deception", 2016, Movie.Type.MOVIE, null, "tt5451640"),
                new Movie("Uncharted 3: Drake's Deception", 2011, Movie.Type.VIDEO_GAME, null, "tt1800763"),
                new Movie("Deception", 1932, Movie.Type.MOVIE, null, "tt0022750"),
                new Movie("Reconception", 2016, Movie.Type.SHORT, null, "tt5567236"),
                new Movie("Perceptions", 2014, Movie.Type.SERIES, null, "tt4034506"),
                new Movie("Perception", 2012, Movie.Type.MOVIE, null, "tt1829013"),
                new Movie("Inception of Chaos", 2012, Movie.Type.SHORT, null, "tt2762020"),
                new Movie("Conception", 2003, Movie.Type.SHORT, null, "tt0380274"),
                new Movie("Conception", 2013, Movie.Type.SHORT, null, "tt2734796"),
                new Movie("Deceptions", 1992, Movie.Type.MOVIE, null, "tt0193082"),
                new Movie("The Deception", 1909, Movie.Type.SHORT, null, "tt0000845"),
                new Movie("Reception", 2011, Movie.Type.SHORT, null, "tt1879033"),
                new Movie("Deception", 2015, Movie.Type.SHORT, null, "tt5559030"),
                new Movie("Double Deception", 2016, Movie.Type.MOVIE, null, "tt4966012"),
                new Movie("Perception", 2016, Movie.Type.SHORT, null, "tt4927296"),
                new Movie("Reception", 0, Movie.Type.MOVIE, null, "tt4572332"),
                new Movie("Misconception", 2014, Movie.Type.MOVIE, null, "tt3108430"),
                new Movie("The Deception", 1915, Movie.Type.SHORT, null, "tt0442089"),
                new Movie("Deception", 2015, Movie.Type.SERIES, null, "tt5323880"),
                new Movie("Deception", 1995, Movie.Type.MOVIE, null, "tt0112837"),
                new Movie("Miss-Twin Ception", 2014, Movie.Type.MOVIE, null, "tt4250098"),
                new Movie("Lies and Deception", 2005, Movie.Type.MOVIE, null, "tt0456145"),
                new Movie("A Perception", 2015, Movie.Type.MOVIE, null, "tt5053098"),
                new Movie("Deception", 0, Movie.Type.SHORT, null, "tt4706532"),
                new Movie("#Deception", 2013, Movie.Type.SHORT, null, "tt3042640"),
                new Movie("Misconceptions", 2006, Movie.Type.SERIES, null, "tt0460663"),
                new Movie("Immaculate Conception", 1992, Movie.Type.MOVIE, null, "tt0104489"),
                new Movie("Deception", 0, Movie.Type.MOVIE, null, "tt3260596"),
                new Movie("Deception", 2014, Movie.Type.SHORT, null, "tt3841264"),
                new Movie("Altered Perception", 0, Movie.Type.MOVIE, null, "tt3165264"),
                new Movie("The Deception", 1915, Movie.Type.SHORT, null, "tt0441170"),
                new Movie("reConception", 2014, Movie.Type.SHORT, null, "tt3145046"),
                new Movie("Perception", 2014, Movie.Type.SHORT, null, "tt3948816"),
                new Movie("From Conception to Birth", 2005, Movie.Type.MOVIE, null, "tt0451061"),
                new Movie("Perception", 2013, Movie.Type.SHORT, null, "tt2881446"),
                new Movie("The Receptionist", 2017, Movie.Type.MOVIE, null, "tt4486838"),
                new Movie("Deception", 2012, Movie.Type.SHORT, null, "tt2437104"),
                new Movie("P rception", 2008, Movie.Type.SHORT, null, "tt3746682"),
                new Movie("Deception", 2006, Movie.Type.SHORT, null, "tt0898906"),
                new Movie("Preconception", 0, Movie.Type.MOVIE, null, "tt4789302"),
                new Movie("Web of Deception", 1994, Movie.Type.MOVIE, null, "tt0108530"),
                new Movie("Exception to the Rule", 1997, Movie.Type.MOVIE, null, "tt0119085"),
                new Movie("Inception (Sweded)", 2011, Movie.Type.SHORT, null, "tt2251371"),
                new Movie("Perception", 2016, Movie.Type.SHORT, null, "tt5548038"),
                new Movie("The Panama Deception", 1992, Movie.Type.MOVIE, null, "tt0105089"),
                new Movie("Sensory Perception", 2015, Movie.Type.MOVIE, null, "tt1618473"),
                new Movie("Chronception", 2011, Movie.Type.SHORT, null, "tt2967050"),
                new Movie("Deception", 2010, Movie.Type.SHORT, null, "tt4119064"),
                new Movie("Inception: In 60 Seconds", 2013, Movie.Type.SHORT, null, "tt3262402"),
                new Movie("Needle Drop: Inception", 2016, Movie.Type.SHORT, null, "tt4650070"),
                new Movie("Déception", 1917, Movie.Type.SHORT, null, "tt0486308"),
                new Movie("Reception", 2010, Movie.Type.SHORT, null, "tt1950320"),
                new Movie("The Deception", 1912, Movie.Type.SHORT, null, "tt0442088"),
                new Movie("Desire and Deception", 2001, Movie.Type.MOVIE, null, "tt0293084"),
                new Movie("Reception", 1967, Movie.Type.SHORT, null, "tt0237640"),
                new Movie("Intimate Deception", 1997, Movie.Type.MOVIE, null, "tt0119376"),
                new Movie("Exceptionals", 2014, Movie.Type.SERIES, null, "tt3284242"),
                new Movie("Deception", 2010, Movie.Type.SHORT, null, "tt2010969"),
                new Movie("Reception", 2011, Movie.Type.SHORT, null, "tt2292889"),
                new Movie("A Circle of Deception", 1960, Movie.Type.MOVIE, null, "tt0054750"),
                new Movie("Reception", 2015, Movie.Type.SHORT, null, "tt5146608"),
                new Movie("Conception", 1998, Movie.Type.MOVIE, null, "tt0115935"),
                new Movie("Deception", 2008, Movie.Type.MOVIE, null, "tt1347323"),
                new Movie("Liberty Deception", 2016, Movie.Type.VIDEO_GAME, null, "tt5480046"),
                new Movie("Conception", 1996, Movie.Type.SHORT, null, "tt0369344"),
                new Movie("Conception", 2014, Movie.Type.SHORT, null, "tt5070066"),
                new Movie("Welcome Back, Brotter", 2009, Movie.Type.SERIES, null, "tt2080268"),
                new Movie("Coke Studio", 2008, Movie.Type.SERIES, null, "tt3416322"),
                new Movie("Conception", 2012, Movie.Type.SHORT, null, "tt2763302"),
                new Movie("Conception", 2009, Movie.Type.SHORT, null, "tt1567762"),
                new Movie("The Urban Monkey", 2009, Movie.Type.SERIES, null, "tt1949047"),
                new Movie("Laid to Rest 3: Conception", 0, Movie.Type.MOVIE, null, "tt4106848"),
                new Movie("Deception", 2015, Movie.Type.SHORT, null, "tt4834328"),
                new Movie("Bad Reception", 2009, Movie.Type.MOVIE, null, "tt1334525"),
                new Movie("Interception", 2010, Movie.Type.SHORT, null, "tt1665742"),
                new Movie("Deception", 2013, Movie.Type.SHORT, null, "tt3467720"),
                new Movie("Laws of Deception", 1997, Movie.Type.MOVIE, null, "tt0187236"),
                new Movie("Perception", 2013, Movie.Type.SHORT, null, "tt3237694"),
                new Movie("The Gay Deception", 1935, Movie.Type.MOVIE, null, "tt0026400"),
                new Movie("Deception", 1999, Movie.Type.SHORT, null, "tt0290557"),
                new Movie("Deception", 2008, Movie.Type.MOVIE, null, "tt1528291"),
                new Movie("Дом с секретом", 1956, Movie.Type.MOVIE, null, "tt0049339"),
                new Movie("Deception", 2010, Movie.Type.SHORT, null, "tt1826649"),
                new Movie("Interception", 2009, Movie.Type.SHORT, null, "tt1404691"),
                new Movie("Deception", 2010, Movie.Type.SHORT, null, "tt1818450"),
                new Movie("Deception", 2005, Movie.Type.SHORT, null, "tt0469065"),
                new Movie("Deception", 2010, Movie.Type.SHORT, null, "tt1669571"),
                new Movie("Reception", 2012, Movie.Type.SHORT, null, "tt2497422"),
                new Movie("Recipe for Deception", 2016, Movie.Type.SERIES, null, "tt5464192"),
                new Movie("Deception", 2015, Movie.Type.SHORT, null, "tt5228130"),
                new Movie("The Exception", 2007, Movie.Type.SHORT, null, "tt1058528"),
                new Movie("Art of Deception", 2016, Movie.Type.MOVIE, null, "tt1754316"),
                new Movie("Claddagh", 2012, Movie.Type.SERIES, null, "tt2413798"),
                new Movie("Triangle", 2014, Movie.Type.SERIES, null, "tt5475622"),
                new Movie("Катастрофа", 1986, Movie.Type.SERIES, null, "tt1909431"),
                new Movie("Brain Hacker", 2014, Movie.Type.SERIES, null, "tt3552378"),
                new Movie("Matlock Police", 1971, Movie.Type.SERIES, null, "tt0643762"),
                new Movie("Acception", 2012, Movie.Type.SHORT, null, "tt2665906"),
                new Movie("Deception", 2011, Movie.Type.SHORT, null, "tt1918768"),
                new Movie("Buddy Jackson", 2006, Movie.Type.SERIES, null, "tt1395350"),
                new Movie("Street Behavior", 2012, Movie.Type.SERIES, null, "tt2872932"),
                new Movie("Dateline on ID", 2008, Movie.Type.SERIES, null, "tt4968054"),
                new Movie("Deception", 2001, Movie.Type.SHORT, null, "tt0398016"),
                new Movie("Al Murabitun Wa Al Andalus", 2005, Movie.Type.SERIES, null, "tt5649854"),
                new Movie("Sophie et Virginie", 1990, Movie.Type.SERIES, null, "tt2163718"),
                new Movie("Blue Heelers", 1994, Movie.Type.SERIES, null, "tt0527427"),
                new Movie("Battle Plan Under Fire", 2004, Movie.Type.SERIES, null, "tt1853065"),
                new Movie("Закон и порядок: Специальный корпус", 1999, Movie.Type.SERIES, null, "tt0629640"),
                new Movie("Легенда об Искателе", 2008, Movie.Type.SERIES, null, "tt1218962"),
                new Movie("Мотив", 2013, Movie.Type.SERIES, null, "tt3246276"),
                new Movie("Deception", 2009, Movie.Type.SHORT, null, "tt1367030"),
                new Movie("Buddy Complex", 2014, Movie.Type.SERIES, null, "tt4107128"),
                new Movie("The Ford Television Theatre", 1952, Movie.Type.SERIES, null, "tt0581188"),
                new Movie("Deception", 1918, Movie.Type.MOVIE, null, "tt0273520"),
                new Movie("Даллас", 1978, Movie.Type.SERIES, null, "tt0965949"),
                new Movie("The New Adventures of Black Beauty", 1990, Movie.Type.SERIES, null, "tt1514379"),
                new Movie("Deception", 1913, Movie.Type.SHORT, null, "tt0441169"),
                new Movie("Holby City", 1999, Movie.Type.SERIES, null, "tt0602516"),
                new Movie("The 20th Century-Fox Hour", 1955, Movie.Type.SERIES, null, "tt0501909"),
                new Movie("Bronk", 1975, Movie.Type.SERIES, null, "tt0532627"),
                new Movie("Zane Grey Theater", 1956, Movie.Type.SERIES, null, "tt0754234"),
                new Movie("Reception", 2009, Movie.Type.SHORT, null, "tt1530982"),
                new Movie("Cameo Theatre", 1950, Movie.Type.SERIES, null, "tt0535612"),
                new Movie("Deception", 2011, Movie.Type.SHORT, null, "tt5015278"),
                new Movie("Time Traveller", 2014, Movie.Type.SERIES, null, "tt5461814"),
                new Movie("Юные Титаны", 2003, Movie.Type.SERIES, null, "tt0718994"),
                new Movie("Dateline NBC", 1992, Movie.Type.SERIES, null, "tt3075192"),
                new Movie("Your Bleeped Up Brain", 2013, Movie.Type.SERIES, null, "tt3088488"),
                new Movie("Эльфийская песнь", 2004, Movie.Type.SERIES, null, "tt0909541"),
                new Movie("Absolute Duo", 2015, Movie.Type.SERIES, null, "tt4624700"),
                new Movie("Доктор Хаус", 2004, Movie.Type.SERIES, null, "tt0606019"),
                new Movie("Убойный отдел", 1993, Movie.Type.SERIES, null, "tt0604357"),
                new Movie("Копы-новобранцы", 2010, Movie.Type.SERIES, null, "tt2875892"),
                new Movie("Reception", 2011, Movie.Type.SHORT, null, "tt2073064"),
                new Movie("Kokumeikan: Trap Simulation Game", 1996, Movie.Type.VIDEO_GAME, null, "tt0844702"),
                new Movie("Silverwing", 2003, Movie.Type.SERIES, null, "tt0849276"),
                new Movie("Reception", 2005, Movie.Type.SHORT, null, "tt3026132"),
                new Movie("Deception", 2001, Movie.Type.MOVIE, null, "tt2376934"),
                new Movie("Within These Walls", 1974, Movie.Type.SERIES, null, "tt0749588")
        );

        assertEquals(expected, parser.parse(getResourceContents("parser/test_data_imdb.html")));
    }
}